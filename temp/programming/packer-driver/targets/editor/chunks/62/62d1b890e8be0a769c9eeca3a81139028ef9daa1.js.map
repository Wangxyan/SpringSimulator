{"version":3,"sources":["file:///D:/CODE/cocos_workspace/%E8%83%8C%E5%8C%85%E8%8B%B1%E9%9B%84/assets/Scripts/Scenes/Game_1.ts"],"names":["_decorator","Component","Node","tween","v3","Input","director","Vec3","Tween","AudioManager","EventListener","GameController","OpenPopupManager","PopupManager","GameEvent","BattleUIManager","BgManager","BoxManager","GridManager","GridMapManager","HeroManager","MonsterManager","SkillManager","WeaponManager","GameDefine","ccclass","property","Game","_battleMapUpPosY","_battleMapDownPosy","onLoad","instance","playMusic","gameTouch","showGamePopup","init","gridManager","bgManager","gridMapManager","weaponManager","heroManager","monsterManager","skillManager","onTapBtn","setTweenAnim","removeWeaponList","main","duration","active","setScale","to","scale","easing","call","start","onGameStart","gameStart","gameOver","onGameOver","stopAll","clear","hideAll","resume","loadScene","onBattleBtn","battleMap","position","showHideHero","emit","INIT_HERO_SKILL","setCurChapterEvent","showHideRemoveList","onResertSelectBg","SHOW_HIDE_SKILL_LIST","WEAPON_REMOVE_REFRESH","onTouchStart","event","preventSwallow","wpos","getUILocation","GAME_TOUCH_START","onTouchMove","GAME_TOUCH_MOVE","onTouchEnd","GAME_TOUCH_END","onTouchCancle","GAME_TOUCH_CANCLE","onEnable","gameCtrl","on","EventType","TOUCH_START","TOUCH_MOVE","TOUCH_END","TOUCH_CANCEL","GAME_OVER","GAME_TAP_BTN","RESERT_SELECT_BAG","GAME_BATTLE_START","onDisable","off","boxManager","battleUIManager"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, screen, Size, view, UITransform, tween, v3, EventTouch, Input, director, Button, Sprite, instantiate, Prefab, Vec3, Tween } from 'cc';\r\nimport { Constants } from '../Constants';\r\nimport { AudioManager } from '../Frame/AudioManager';\r\nimport { EventListener } from '../Frame/EventListener';\r\nimport GameController from '../Frame/GameController';\r\nimport { OpenPopupManager } from '../Frame/OpenPopupManager';\r\nimport { PopupManager } from '../Frame/PopupManager';\r\nimport { ResourcesUtil } from '../Frame/ResourcesUtil';\r\nimport { GridData } from '../Game/Data/GridData';\r\nimport { GameEvent } from '../Game/Event/GameEvent';\r\nimport { BattleUIManager } from '../Game/Mgr/BattleUIManager';\r\nimport { BgManager } from '../Game/Mgr/BgManager';\r\nimport { BoxManager } from '../Game/Mgr/BoxManager';\r\nimport { GridManager } from '../Game/Mgr/GridManager';\r\nimport { GridMapManager } from '../Game/Mgr/GridMapManager';\r\nimport { HeroManager } from '../Game/Mgr/HeroManager';\r\nimport { MonsterManager } from '../Game/Mgr/MonsterManager';\r\nimport { SkillManager } from '../Game/Mgr/SkillManager';\r\nimport { WeaponManager } from '../Game/Mgr/WeaponManager';\r\nimport { GameDefine } from '../GameDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Game')\r\nexport class Game extends Component {\r\n    @property(Node)\r\n    gameCtrl: Node = null;\r\n    @property(Node)\r\n    battleMap: Node = null;\r\n    @property(Node)\r\n    removeWeaponList: Node = null;\r\n    @property(Node)\r\n    openBox: Node = null;\r\n    @property(BgManager)\r\n    bgManager: BgManager = null;\r\n    @property(GridMapManager)\r\n    gridMapManager: GridMapManager = null;\r\n    @property(GridManager)\r\n    gridManager: GridManager = null;\r\n    @property(WeaponManager)\r\n    weaponManager: WeaponManager = null;\r\n    @property(HeroManager)\r\n    heroManager: HeroManager = null;\r\n    @property(BoxManager)\r\n    boxManager: BoxManager = null;\r\n    @property(MonsterManager)\r\n    monsterManager: MonsterManager = null;\r\n    @property(BattleUIManager)\r\n    battleUIManager: BattleUIManager = null;\r\n    @property(SkillManager)\r\n    skillManager: SkillManager = null;\r\n\r\n    private _battleMapUpPosY = 1200;\r\n    private _battleMapDownPosy = 200;\r\n\r\n    onLoad() {\r\n        AudioManager.instance.playMusic(2, true);\r\n        GameDefine.gameTouch = false;\r\n        OpenPopupManager.instance.showGamePopup();\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.gridManager.init();\r\n        this.bgManager.init();\r\n        this.gridMapManager.init();\r\n        this.weaponManager.init();\r\n        this.heroManager.init();\r\n        this.monsterManager.init();\r\n        this.skillManager.init();\r\n        this.onTapBtn();\r\n    }\r\n    /* 触碰开始 */\r\n    onTapBtn() {\r\n        GameDefine.gameTouch = true;\r\n        this.setTweenAnim(this.removeWeaponList, 0.3);\r\n    }\r\n\r\n    /* 设置动画 */\r\n    setTweenAnim(main: Node, duration: number) {\r\n        main.active = true;\r\n        main.setScale(0.5, 0.5);\r\n        tween(main)\r\n            .to(duration, { scale: v3(1, 1, 1) }, { easing: 'backOut' })\r\n            .call(() => {\r\n                // 弹窗已完全展示\r\n            })\r\n            .start();\r\n    }\r\n\r\n\r\n    /**游戏开始 */\r\n    onGameStart() {\r\n        GameDefine.gameTouch = false;\r\n        GameDefine.gameStart = true;\r\n        GameDefine.gameOver = false;\r\n    }\r\n\r\n    /**游戏结束 */\r\n    onGameOver() {\r\n        GameDefine.gameTouch = false;\r\n        GameDefine.gameStart = false;\r\n        GameDefine.gameOver = true;\r\n        Tween.stopAll();\r\n        this.clear();\r\n        PopupManager.instance.hideAll();\r\n        GameController.resume();\r\n        director.loadScene('Game');\r\n    }\r\n\r\n    /* 战斗 */\r\n    onBattleBtn() {\r\n        tween(this.battleMap).to(0.5, { position: new Vec3(0, this._battleMapDownPosy, 0) }, { easing: 'sineInOut' }).call(() => {\r\n            //显示英雄\r\n            this.heroManager.showHideHero(true);\r\n            //初始化技能\r\n            EventListener.emit(GameEvent.INIT_HERO_SKILL);\r\n            //设置当前刷怪事件\r\n            this.monsterManager.setCurChapterEvent();\r\n            this.weaponManager.showHideRemoveList(false);\r\n            //游戏开始\r\n            this.onGameStart();\r\n        }).start();\r\n    }\r\n\r\n\r\n    /* 重新调整背包 */\r\n    onResertSelectBg() {\r\n        tween(this.battleMap).to(0.5, { position: v3(0, this._battleMapUpPosY, 0) }, { easing: 'sineInOut' }).call(() => {\r\n            EventListener.emit(GameEvent.SHOW_HIDE_SKILL_LIST, false);\r\n            this.heroManager.showHideHero(false);\r\n            GameDefine.gameStart = false;\r\n            EventListener.emit(GameEvent.WEAPON_REMOVE_REFRESH);\r\n            this.weaponManager.showHideRemoveList(true);\r\n            this.setTweenAnim(this.removeWeaponList, 0.3);\r\n            GameDefine.gameTouch = true;\r\n        }).start();\r\n    }\r\n\r\n    /* 触摸点击 */\r\n    onTouchStart(event: EventTouch) {\r\n        event.preventSwallow = true;\r\n        if (GameDefine.gameTouch) {\r\n            let wpos = event.getUILocation();\r\n            EventListener.emit(GameEvent.GAME_TOUCH_START, wpos);\r\n        }\r\n    }\r\n\r\n    /* 触摸移动 */\r\n    onTouchMove(event: EventTouch) {\r\n        event.preventSwallow = true;\r\n        if (GameDefine.gameTouch) {\r\n            let wpos = event.getUILocation();\r\n            EventListener.emit(GameEvent.GAME_TOUCH_MOVE, wpos);\r\n        }\r\n    }\r\n\r\n    /* 触摸结束 */\r\n    onTouchEnd(event: EventTouch) {\r\n        event.preventSwallow = true;\r\n        if (GameDefine.gameTouch) {\r\n            let wpos = event.getUILocation();\r\n            EventListener.emit(GameEvent.GAME_TOUCH_END, wpos);\r\n        }\r\n    }\r\n\r\n    /* 触摸取消 */\r\n    onTouchCancle(event: EventTouch) {\r\n        event.preventSwallow = true;\r\n        if (GameDefine.gameTouch) {\r\n            let wpos = event.getUILocation();\r\n            EventListener.emit(GameEvent.GAME_TOUCH_CANCLE, wpos);\r\n        }\r\n    }\r\n\r\n    protected onEnable(): void {\r\n        this.gameCtrl.on(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n        this.gameCtrl.on(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        this.gameCtrl.on(Input.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        this.gameCtrl.on(Input.EventType.TOUCH_CANCEL, this.onTouchCancle, this);\r\n        EventListener.on(GameEvent.GAME_OVER, this.onGameOver, this);\r\n        EventListener.on(GameEvent.GAME_TAP_BTN, this.onTapBtn, this);\r\n        EventListener.on(GameEvent.RESERT_SELECT_BAG, this.onResertSelectBg, this);\r\n        EventListener.on(GameEvent.GAME_BATTLE_START, this.onBattleBtn, this);\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        this.gameCtrl.off(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n        this.gameCtrl.off(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        this.gameCtrl.off(Input.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        this.gameCtrl.off(Input.EventType.TOUCH_CANCEL, this.onTouchCancle, this);\r\n        EventListener.off(GameEvent.GAME_OVER, this.onGameOver, this);\r\n        EventListener.off(GameEvent.GAME_TAP_BTN, this.onTapBtn, this);\r\n        EventListener.off(GameEvent.RESERT_SELECT_BAG, this.onResertSelectBg, this);\r\n        EventListener.off(GameEvent.GAME_BATTLE_START, this.onBattleBtn, this);\r\n    }\r\n\r\n    clear() {\r\n        // 数据清理整理\r\n        this.bgManager.clear();\r\n        this.heroManager.clear();\r\n        this.gridManager.clear();\r\n        this.weaponManager.clear();\r\n        this.monsterManager.clear();\r\n        this.boxManager.clear();\r\n        this.battleUIManager.clear();\r\n        this.skillManager.clear();\r\n    }\r\n}\r\n\r\n\r\n"]}