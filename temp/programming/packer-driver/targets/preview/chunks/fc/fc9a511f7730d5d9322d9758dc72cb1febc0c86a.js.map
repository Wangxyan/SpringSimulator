{"version":3,"sources":["file:///D:/CODE/cocos_workspace/%E8%83%8C%E5%8C%85%E8%8B%B1%E9%9B%84/assets/Scripts/Game/Battle/MonsterHpItem.ts"],"names":["_decorator","Node","ProgressBar","tween","UIOpacity","UITransform","BaseComponent","PoolManager","GameDefine","ccclass","property","MonsterHpItem","_com","init","com","barAnim","getComponent","width","node","progress","opacity","setMonsterHp","curHp","maxHp","unschedule","setMonsterHide","curWidth","bar","endWidth","offsetX","scheduleOnce","by","call","clear","start","setMonsterHpPos","curPos","getColliderPos","height","setPosition","x","y","instance","putNode","childUpdate","dt","gameStart"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, ProgressBar, tween, UIOpacity, UITransform } from 'cc';\r\nimport { MonsterBase } from '../Monster/MonsterBase';\r\nimport BaseComponent from '../../Frame/BaseComponent';\r\nimport { PoolManager } from '../../Frame/PoolManager';\r\nimport { GameDefine } from '../../GameDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('MonsterHpItem')\r\nexport class MonsterHpItem extends BaseComponent {\r\n    @property(Node)\r\n    barAnim: Node = null;\r\n    @property(Node)\r\n    bar: Node = null;\r\n    private _com: MonsterBase = null;\r\n\r\n    init(com: MonsterBase) {\r\n        this.barAnim.getComponent(UITransform).width = this.node.getComponent(UITransform).width;\r\n        this.getComponent(ProgressBar).progress = 1;\r\n        this.getComponent(UIOpacity).opacity = 0;\r\n        this._com = com;\r\n    }\r\n\r\n    setMonsterHp(curHp: number, maxHp: number) {\r\n        if (curHp <= 0) { curHp = 0 };\r\n        this.unschedule(this.setMonsterHide);\r\n        this.getComponent(UIOpacity).opacity = 255;\r\n        this.getComponent(ProgressBar).progress = curHp / maxHp;\r\n        let curWidth = this.bar.getComponent(UITransform).width;\r\n        let endWidth = this.barAnim.getComponent(UITransform).width;\r\n        let offsetX = endWidth - curWidth;\r\n        this.scheduleOnce(this.setMonsterHide, 0.5);\r\n        tween(this.barAnim.getComponent(UITransform)).by(0.2, { width: -offsetX }).call((() => {\r\n            if (curHp <= 0) {\r\n                this.clear();\r\n            }\r\n        })).start();\r\n    }\r\n\r\n    setMonsterHide() {\r\n        this.getComponent(UIOpacity).opacity = 0;\r\n    }\r\n\r\n    setMonsterHpPos() {\r\n        let curPos = this._com.getColliderPos();\r\n        let height = this._com.node.getComponent(UITransform).height;\r\n        this.node.setPosition(curPos.x, curPos.y + height * 2 / 3, 0);\r\n    }\r\n\r\n    clear() {\r\n        PoolManager.instance.putNode(this.node);\r\n    }\r\n\r\n    protected childUpdate(dt: number): void {\r\n        if (GameDefine.gameStart) {\r\n            if (this._com) {\r\n                this.setMonsterHpPos();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}